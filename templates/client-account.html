{% extends "base.html" %}

{% block title %}Your Account{% endblock %}

{% block content %}

<style>
    .info-button {
        width: 19px; /* Set the width and height to control the button size */
        height: 19px;
        border-radius: 50%; /* Make the button round */
        background-color: #7cb1cc; /* Add background color */
        color: white; /* Set text color */
        border: none; /* Remove the border */
        cursor: pointer; /* Add a pointer cursor on hover */
    }

     .logout-link {
        position: absolute;
        top: 50px; /* Adjust the top position as needed */
        right: 20px;
    }

    /* Add styles for the "Back to Flight Search" button */
    .back-button {
        position: absolute;
        top: 10px;
        right: 10px;
    }
</style>

	<div class="container">
        <a href="/flight-search" class="back-button">
        <button class="btn btn-primary">
            <i class="fas fa-plane-departure"></i> Back to Flight Search
        </button>
        </a>
        <a href="/logout" class="logout-link">Logout</a>
        <h1>Your Account</h1>
        <br>

		<div class="personal-info">
			<p style="font-weight: bold; font-size: 18px;">Personal Data</p>
            {% for client in client_data %}
            <p><strong>Name:</strong> {{ client.user_name }}</p>
            <p><strong>Email:</strong>{{ client.user_email }}</p>
            <p><strong>Tier: </strong>{{ client.tier }}
                <button class="info-button" onclick="toggleInfo('info{{ loop.index }}')">i</button>
            </p>
                <div class="tier-info" id="info{{ loop.index }}" style="display: none;">
                    ---------------------------------------------------------------------------------------------------------<br>
                    You earn 1 mile for every mile flown. Different tiers come with different benefits.
                    <br>
                    Bronze Tier: You start as a Bronze member
                    <br>
                    Silver Tier: With 1.000 flown miles, you reach the Silver tier
                    <br>
                    Gold Tier: You achieve Gold status with 10.000 flown miles.
                    <br>
                    ---------------------------------------------------------------------------------------------------------<br>
                </div>
			<p><strong> Total miles:</strong> {{client.miles }}</p>
            {% endfor %}
		</div>

        <br>
		<div class="flight-history">
			<p style="font-weight: bold; font-size: 18px;">Flight History</p>
			<table style="table-layout: auto; width: 100%;">
                <tr>
                    <th style="width: auto;">Passenger</th>
                    <th style="width: auto;">Date</th>
                    <th style="width: auto;">Departure</th>
                    <th style="width: auto;">Destination</th>
                    <th style="width: auto;">Departure Time (UTC)</th>
                    <th style="width: auto;">Arrival Time (UTC)</th>
                    <th style="width: auto;">Class</th>
                    <th style="width: auto;">Miles</th>
                    <th style="width: auto;">Stornieren</th>
                    <th style="width: auto;">Check-In</th>
				</tr>
				<tr>
                    {% for flight in flight_history %}
                    <td>{{ flight.ticket_name }}</td>
                    <td> {{ flight.ticket_date }}</td>
                    <td>{{ flight.flight_source}}</td>
                    <td> {{ flight.flight_destination }}</td>
                    <td>{{ flight.flight_depTime}}</td>
                    <td>{{ flight.flight_arrTime}}</td>
					<td>{{ flight.ticket_class}}</td>
                    <td> {{ flight.ticket_miles }}</td>
					<td>

                        <button id="stornierenButton{{ loop.index }}"
                            onclick="toggleButton('stornierenButton{{ loop.index }}', 'Pending', 'yellow', 'checkInButton{{ loop.index }}')"
                            style="width: 100px;">Stornieren
                        </button>
                    </td>
                    <td>
                        <button id="checkInButton{{ loop.index }}"
                            onclick="toggleButton('checkInButton{{ loop.index }}', 'Checked In', 'green', 'stornierenButton{{ loop.index }}')"
                            style="width: 100px;">Check-In
                        </button>
                    </td>
                        <tr>
                        {% endfor %}
                    </tr>

                </tr>

		<br>
    </table>

	</div>
	<br><br>


	<script>
    // Initialisiere den Status der Buttons
    const buttonStatus = {
      'stornierenButton1': false,
      'checkInButton1': false,
      'stornierenButton2': false,
      'checkInButton2': false,
    };

    function toggleButton(buttonId, newText, newColor, oppositeButtonId) {
      // Überprüfe, ob der gegnerische Button aktiv ist
      if (!buttonStatus[oppositeButtonId]) {
        const button = document.getElementById(buttonId);
        button.innerHTML = newText;
        button.style.backgroundColor = newColor;
        button.disabled = true;
        buttonStatus[buttonId] = true;

        // Deaktiviere den gegnerischen Button
        const oppositeButton = document.getElementById(oppositeButtonId);
        oppositeButton.disabled = false;
        oppositeButton.style.backgroundColor = '';
        buttonStatus[oppositeButtonId] = false;
      }
    }

    function toggleInfo(infoId) {
        var infoElement = document.getElementById(infoId);
        if (infoElement.style.display === "none") {
            infoElement.style.display = "block";
        } else {
            infoElement.style.display = "none";
        }
    }
	</script>
    </div>

{% endblock %}