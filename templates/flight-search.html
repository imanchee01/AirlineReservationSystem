{% extends "base.html" %}

{% block title %}Flight Search{% endblock %}

{% block content %}
	<!-- Button zum Client-Account -->
	<style>
    .client-account-button {
      position: relative;
      right: 10px;
      top: 10px;
    }
	</style>

	<form action="/client-account" method="GET">
		<button type="submit">Zum Client-Account</button>
	</form>

	<h1>Flight Search</h1>
	<form action="/select-flight" method="get" onsubmit="return validateForm()">
		<div class="row">
			<div class="col-xs-6">
				<label for="departure">Departure City</label>
				<input class="form-control" type="text" id="departure" name="departure" required>
				<br>
				<label for="destination">Destination City:</label>
				<input class="form-control" type="text" id="destination" name="destination" required>
				<div id="error-message" style="color: red;"></div>
				<br><br>
			</div>
			<div class="col-xs-6">
				<label for="departure-date">Departure Date:</label>
				<input class="form-control" type="date" id="departure-date" name="departure_date" required>
				<br>
				<label for="return-date">Return Date:</label>
				<input class="form-control" type="date" id="return-date" name="return_date" required>
				<br><br>
			</div>
		</div>

		<div class="row">
			<div class="col-xs-6">
				<label for="person-count">Number of Persons:</label>
				<select class="form-control" id="person-count" name="person_count">
					<option value="1">1</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5</option>
				</select>
			</div>
		</div>
		<br><br>

		<input class="btn btn-default" type="submit" value="Search Flights">
	</form>

	<br><br>
	<a href="/logout">Logout</a>


	<script>
    const departure_date = document.getElementById("departure-date");
    const return_date = document.getElementById("return-date");
    const departure = document.getElementById("departure");
    const destination = document.getElementById("destination");
    const error_message = document.getElementById("error-message");

    departure_date.min = new Date().toISOString().split('T')[0];
    return_date.min = new Date().toISOString().split('T')[0];

    function update_dates() {
      if (!return_date.value || !departure_date.value) return;

      if (return_date.value < departure_date.value) {
        const return_date_value = return_date.value;
        const departure_date_value = departure_date.value;
        return_date.value = departure_date.value;
        departure_date.value = return_date.value;
      }
    }

    return_date.addEventListener("change", update_dates);
    departure_date.addEventListener("change", update_dates);

    function validateForm() {
      if (departure.value === destination.value) {
        error_message.textContent = "Departure and destination cannot be the same airport.";
        return false; // Block form submission
      } else {
        error_message.textContent = "";
        return true; // Allow form submission
      }
    }

    departure.addEventListener("input", validateForm);
    destination.addEventListener("input", validateForm);
	</script>

{% endblock %}
